{"version":3,"file":"critters.js","sources":["../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/dom.js","../src/css.js","../src/index.js"],"sourcesContent":["// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n * use this file except in compliance with the License. You may obtain a copy of\n * the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations under\n * the License.\n */\nimport { JSDOM } from 'jsdom';\n\n/**\n * Parse HTML into a mutable, serializable DOM Document, provided by JSDOM.\n * @private\n * @param {String} html   HTML to parse into a Document instance\n */\nexport function createDocument (html) {\n  const jsdom = new JSDOM(html, {\n    contentType: 'text/html'\n  });\n  const { window } = jsdom;\n  const document = window.document;\n  document.$jsdom = jsdom;\n  return document;\n}\n/**\n * Serialize a Document to an HTML String\n * @private\n * @param {Document} document   A Document, such as one created via `createDocument()`\n */\nexport function serializeDocument (document) {\n  return document.$jsdom.serialize();\n}\n\n/** Like node.textContent, except it works */\nexport function setNodeText (node, text) {\n  while (node.lastChild) {\n    node.removeChild(node.lastChild);\n  }\n  node.appendChild(node.ownerDocument.createTextNode(text));\n}\n","/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n * use this file except in compliance with the License. You may obtain a copy of\n * the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations under\n * the License.\n */\n\nconst css = require('css');\n\n/**\n * Parse a textual CSS Stylesheet into a Stylesheet instance.\n * Stylesheet is a mutable ReworkCSS AST with format similar to CSSOM.\n * @see https://github.com/reworkcss/css\n * @private\n * @param {String} stylesheet\n * @returns {css.Stylesheet} ast\n */\nexport function parseStylesheet (stylesheet) {\n  return css.parse(stylesheet);\n}\n\n/**\n * Serialize a ReworkCSS Stylesheet to a String of CSS.\n * @private\n * @param {css.Stylesheet} ast          A Stylesheet to serialize, such as one returned from `parseStylesheet()`\n * @param {Object} options              Options to pass to `css.stringify()`\n * @param {Boolean} [options.compress]  Compress CSS output (removes comments, whitespace, etc)\n */\nexport function serializeStylesheet (ast, options) {\n  return css.stringify(ast, options);\n}\n\n/**\n * Converts a walkStyleRules() iterator to mark nodes with `.$$remove=true` instead of actually removing them.\n * This means they can be removed in a second pass, allowing the first pass to be nondestructive (eg: to preserve mirrored sheets).\n * @private\n * @param {Function} iterator   Invoked on each node in the tree. Return `false` to remove that node.\n * @returns {(rule) => void} nonDestructiveIterator\n */\nexport function markOnly (predicate) {\n  return rule => {\n    const sel = rule.selectors;\n    if (predicate(rule) === false) {\n      rule.$$remove = true;\n    }\n    rule.$$markedSelectors = rule.selectors;\n    if (rule._other) {\n      rule._other.$$markedSelectors = rule._other.selectors;\n    }\n    rule.selectors = sel;\n  };\n}\n\n/**\n * Apply filtered selectors to a rule from a previous markOnly run.\n * @private\n * @param {css.Rule} rule The Rule to apply marked selectors to (if they exist).\n*/\nexport function applyMarkedSelectors (rule) {\n  if (rule.$$markedSelectors) {\n    rule.selectors = rule.$$markedSelectors;\n  }\n  if (rule._other) {\n    applyMarkedSelectors(rule._other);\n  }\n}\n\n/**\n * Recursively walk all rules in a stylesheet.\n * @private\n * @param {css.Rule} node       A Stylesheet or Rule to descend into.\n * @param {Function} iterator   Invoked on each node in the tree. Return `false` to remove that node.\n */\nexport function walkStyleRules (node, iterator) {\n  if (node.stylesheet) return walkStyleRules(node.stylesheet, iterator);\n\n  node.rules = node.rules.filter(rule => {\n    if (rule.rules) {\n      walkStyleRules(rule, iterator);\n    }\n    rule._other = undefined;\n    rule.filterSelectors = filterSelectors;\n    return iterator(rule) !== false;\n  });\n}\n\n/**\n * Recursively walk all rules in two identical stylesheets, filtering nodes into one or the other based on a predicate.\n * @private\n * @param {css.Rule} node       A Stylesheet or Rule to descend into.\n * @param {css.Rule} node2      A second tree identical to `node`\n * @param {Function} iterator   Invoked on each node in the tree. Return `false` to remove that node from the first tree, true to remove it from the second.\n */\nexport function walkStyleRulesWithReverseMirror (node, node2, iterator) {\n  if (node2 === null) return walkStyleRules(node, iterator);\n\n  if (node.stylesheet) return walkStyleRulesWithReverseMirror(node.stylesheet, node2.stylesheet, iterator);\n\n  [node.rules, node2.rules] = splitFilter(node.rules, node2.rules, (rule, index, rules, rules2) => {\n    const rule2 = rules2[index];\n    if (rule.rules) {\n      walkStyleRulesWithReverseMirror(rule, rule2, iterator);\n    }\n    rule._other = rule2;\n    rule.filterSelectors = filterSelectors;\n    return iterator(rule) !== false;\n  });\n}\n\n// Like [].filter(), but applies the opposite filtering result to a second copy of the Array without a second pass.\n// This is just a quicker version of generating the compliment of the set returned from a filter operation.\nfunction splitFilter (a, b, predicate) {\n  const aOut = [];\n  const bOut = [];\n  for (let index = 0; index < a.length; index++) {\n    if (predicate(a[index], index, a, b)) {\n      aOut.push(a[index]);\n    } else {\n      bOut.push(a[index]);\n    }\n  }\n  return [aOut, bOut];\n}\n\n// can be invoked on a style rule to subset its selectors (with reverse mirroring)\nfunction filterSelectors (predicate) {\n  if (this._other) {\n    const [a, b] = splitFilter(this.selectors, this._other.selectors, predicate);\n    this.selectors = a;\n    this._other.selectors = b;\n  } else {\n    this.selectors = this.selectors.filter(predicate);\n  }\n}\n\nmodule.exports.parseStylesheet = parseStylesheet;\nmodule.exports.serializeStylesheet = serializeStylesheet\nmodule.exports.markOnly = markOnly\nmodule.exports.applyMarkedSelectors = applyMarkedSelectors\nmodule.exports.walkStyleRules = walkStyleRules\nmodule.exports.walkStyleRulesWithReverseMirror = walkStyleRulesWithReverseMirror","/**\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n * use this file except in compliance with the License. You may obtain a copy of\n * the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations under\n * the License.\n */\n\nimport path from 'path';\nimport prettyBytes from 'pretty-bytes';\n// import sources from 'webpack-sources';\nimport postcss from 'postcss';\nimport cssnano from 'cssnano';\n// import log from 'webpack-log';\n// import log from '@quasar/app/lib/helpers/logger'\nimport { createDocument, serializeDocument, setNodeText } from './dom';\nimport { parseStylesheet, serializeStylesheet, walkStyleRules, walkStyleRulesWithReverseMirror, markOnly, applyMarkedSelectors } from './css';\n// import { tap } from './util';\n\n// Used to annotate this plugin's hooks in Tappable invocations\n// const PLUGIN_NAME = 'critters-webpack-plugin';\n\n/**\n * The mechanism to use for lazy-loading stylesheets.\n * _[JS]_ indicates that a strategy requires JavaScript (falls back to `<noscript>`).\n *\n * - **default:** Move stylesheet links to the end of the document and insert preload meta tags in their place.\n * - **\"body\":** Move all external stylesheet links to the end of the document.\n * - **\"media\":** Load stylesheets asynchronously by adding `media=\"not x\"` and removing once loaded. _[JS]_\n * - **\"swap\":** Convert stylesheet links to preloads that swap to `rel=\"stylesheet\"` once loaded. _[JS]_\n * - **\"js\":** Inject an asynchronous CSS loader similar to [LoadCSS](https://github.com/filamentgroup/loadCSS) and use it to load stylesheets. _[JS]_\n * - **\"js-lazy\":** Like `\"js\"`, but the stylesheet is disabled until fully loaded.\n * @typedef {(default|'body'|'media'|'swap'|'js'|'js-lazy')} PreloadStrategy\n * @public\n */\n\n/**\n * Controls which keyframes rules are inlined.\n *\n * - **\"critical\":** _(default)_ inline keyframes rules that are used by the critical CSS.\n * - **\"all\":** Inline all keyframes rules.\n * - **\"none\":** Remove all keyframes rules.\n * @typedef {('critical'|'all'|'none')} KeyframeStrategy\n * @private\n * @property {String} keyframes     Which {@link KeyframeStrategy keyframe strategy} to use (default: `critical`)_\n */\n\n/**\n * Controls log level of the plugin. Specifies the level the logger should use. A logger will\n * not produce output for any log level beneath the specified level. Available levels and order\n * are:\n *\n * - **\"info\"** _(default)_\n * - **\"warn\"**\n * - **\"error\"**\n * - **\"trace\"**\n * - **\"debug\"**\n * - **\"silent\"**\n * @typedef {('info'|'warn'|'error'|'trace'|'debug'|'silent')} LogLevel\n * @public\n */\n\n/**\n * All optional. Pass them to `new Critters({ ... })`.\n * @public\n * @typedef Options\n * @property {Boolean} external     Inline styles from external stylesheets _(default: `true`)_\n * @property {Number} inlineThreshold Inline external stylesheets smaller than a given size _(default: `0`)_\n * @property {Number} minimumExternalSize If the non-critical external stylesheet would be below this size, just inline it _(default: `0`)_\n * @property {Boolean} pruneSource  Remove inlined rules from the external stylesheet _(default: `true`)_\n * @property {Boolean} mergeStylesheets Merged inlined stylesheets into a single <style> tag _(default: `true`)_\n * @property {String} preload       Which {@link PreloadStrategy preload strategy} to use\n * @property {Boolean} noscriptFallback Add `<noscript>` fallback to JS-based strategies\n * @property {Boolean} inlineFonts  Inline critical font-face rules _(default: `false`)_\n * @property {Boolean} preloadFonts Preloads critical fonts _(default: `true`)_\n * @property {Boolean} fonts        Shorthand for setting `inlineFonts`+`preloadFonts`\n *  - Values:\n *  - `true` to inline critical font-face rules and preload the fonts\n *  - `false` to don't inline any font-face rules and don't preload fonts\n * @property {String} keyframes     Controls which keyframes rules are inlined.\n *  - Values:\n *  - `\"critical\"`: _(default)_ inline keyframes rules used by the critical CSS\n *  - `\"all\"` inline all keyframes rules\n *  - `\"none\"` remove all keyframes rules\n * @property {Boolean} compress     Compress resulting critical CSS _(default: `true`)_\n * @property {String} logLevel      Controls {@link LogLevel log level} of the plugin _(default: `\"info\"`)_\n */\n\n/**\n * Create a Critters plugin instance with the given options.\n * @public\n * @param {Options} options Options to control how Critters inlines CSS.\n * @example\n * // webpack.config.js\n * module.exports = {\n *   plugins: [\n *     new Critters({\n *       // Outputs: <link rel=\"preload\" onload=\"this.rel='stylesheet'\">\n *       preload: 'swap',\n *\n *       // Don't inline critical font-face rules, but preload the font URLs:\n *       preloadFonts: true\n *     })\n *   ]\n * }\n */\nexport default class Critters {\n  /** @private */\n  constructor(options) {\n    this.options = Object.assign({ logLevel: 'info' }, options || {});\n    this.options.pruneSource = this.options.pruneSource !== false;\n    this.urlFilter = this.options.filter;\n    if (this.urlFilter instanceof RegExp) {\n      this.urlFilter = this.urlFilter.test.bind(this.urlFilter);\n    }\n    this.logger = options.logger;\n    this.outputPath = options.outputPath\n    this.publicPath = options.publicPath\n  }\n\n  /**\n   * Invoked by Webpack during plugin initialization\n   */\n  /*\n  apply (compiler) {\n    // hook into the compiler to get a Compilation instance...\n    tap(compiler, 'compilation', PLUGIN_NAME, false, compilation => {\n      // ... which is how we get an \"after\" hook into html-webpack-plugin's HTML generation.\n      if (compilation.hooks && compilation.hooks.htmlWebpackPluginAfterHtmlProcessing) {\n        tap(compilation, 'html-webpack-plugin-after-html-processing', PLUGIN_NAME, true, (htmlPluginData, callback) => {\n          this.process(compiler, compilation, htmlPluginData.html)\n            .then(html => { callback(null, { html }); })\n            .catch(callback);\n        });\n      } else {\n        // If html-webpack-plugin isn't used, process the first HTML asset as an optimize step\n        tap(compilation, 'optimize-assets', PLUGIN_NAME, true, (assets, callback) => {\n          let htmlAssetName;\n          for (const name in assets) {\n            if (name.match(/\\.html$/)) {\n              htmlAssetName = name;\n              break;\n            }\n          }\n          if (!htmlAssetName) return callback(Error('Could not find HTML asset.'));\n          const html = assets[htmlAssetName].source();\n          if (!html) return callback(Error('Empty HTML asset.'));\n\n          this.process(compiler, compilation, String(html))\n            .then(html => {\n              assets[htmlAssetName] = new sources.RawSource(html);\n              callback();\n            })\n            .catch(callback);\n        });\n      }\n    });\n  }\n  */\n\n  /**\n   * Read the contents of a file from Webpack's input filesystem\n   */\n  readFile (filename) {\n    const fs = this.fs;\n    return new Promise((resolve, reject) => {\n      const callback = (err, data) => {\n        if (err) reject(err);\n        else resolve(data);\n      };\n      if (fs && fs.readFile) {\n        fs.readFile(filename, callback);\n      } else {\n        require('fs').readFile(filename, 'utf8', callback);\n      }\n    });\n  }\n\n  /**\n   * Apply critical CSS processing to html-webpack-plugin\n   */\n  async process (html) {\n    // const outputPath = compiler.options.output.path;\n    // const publicPath = compiler.options.output.publicPath;\n\n    // Parse the generated HTML in a DOM we can mutate\n    const document = createDocument(html);\n\n    document.body.className = this.bodyClasses\n\n    // `external:false` skips processing of external sheets\n    if (this.options.external !== false) {\n      const externalSheets = [].slice.call(document.querySelectorAll('link[rel=\"stylesheet\"]'));\n      await Promise.all(externalSheets.map(\n        link => this.embedLinkedStylesheet(link)\n      ));\n    }\n\n    // go through all the style tags in the document and reduce them to only critical CSS\n    const styles = [].slice.call(document.querySelectorAll('style'));\n    await Promise.all(styles.map(\n      style => this.processStyle(style, document)\n    ));\n\n    if (this.options.mergeStylesheets !== false && styles.length !== 0) {\n      await this.mergeStylesheets(document);\n    }\n\n    // serialize the document back to HTML and we're done\n    return serializeDocument(document);\n  }\n\n  async mergeStylesheets (document) {\n    const styles = [].slice.call(document.querySelectorAll('style'));\n    if (styles.length === 0) {\n      this.logger.warn('Merging inline stylesheets into a single <style> tag skipped, no inline stylesheets to merge');\n      return;\n    }\n    const first = styles[0];\n    let sheet = first.textContent;\n    for (let i = 1; i < styles.length; i++) {\n      const node = styles[i];\n      sheet += node.textContent;\n      node.remove();\n    }\n    if (this.options.compress !== false) {\n      const before = sheet;\n      const processor = postcss([cssnano()]);\n      const result = await processor.process(before, { from: undefined });\n      // @todo sourcemap support (elsewhere first)\n      sheet = result.css;\n    }\n    setNodeText(first, sheet);\n  }\n\n  /**\n   * Inline the target stylesheet referred to by a <link rel=\"stylesheet\"> (assuming it passes `options.filter`)\n   */\n  async embedLinkedStylesheet (link) {\n    const href = link.getAttribute('href');\n    const media = link.getAttribute('media');\n    const document = link.ownerDocument;\n\n    const preloadMode = this.options.preload;\n\n    // skip filtered resources, or network resources if no filter is provided\n    if (this.urlFilter ? this.urlFilter(href) : href.match(/^(https?:)?\\/\\//)) return Promise.resolve();\n\n    // path on disk (with output.publicPath removed)\n    let normalizedPath = href.replace(/^\\//, '');\n    const pathPrefix = (this.publicPath || '').replace(/(^\\/|\\/$)/g, '') + '/';\n    if (normalizedPath.indexOf(pathPrefix) === 0) {\n      normalizedPath = normalizedPath.substring(pathPrefix.length).replace(/^\\//, '');\n    }\n    const filename = path.resolve(this.outputPath, normalizedPath);\n\n    // try to find a matching asset by filename in webpack's output (not yet written to disk)\n    const relativePath = path.relative(this.outputPath, filename).replace(/^\\.\\//, '');\n    // const asset = compilation.assets[relativePath];\n    const asset = false\n\n    // Attempt to read from assets, falling back to a disk read\n    // let sheet = asset && asset.source();\n    let sheet = false\n    if (!sheet) {\n      try {\n        sheet = await this.readFile(filename);\n        this.logger.warn(`Stylesheet \"${relativePath}\" not found in assets, but a file was located on disk.${this.options.pruneSource ? ' This means pruneSource will not be applied.' : ''}`);\n      } catch (e) {\n        this.logger.warn(`Unable to locate stylesheet: ${relativePath}`);\n        return;\n      }\n    }\n\n    // CSS loader is only injected for the first sheet, then this becomes an empty string\n    let cssLoaderPreamble = `function $loadcss(u,m,l){(l=document.createElement('link')).rel='stylesheet';l.href=u;document.head.appendChild(l)}`;\n    const lazy = preloadMode === 'js-lazy';\n    if (lazy) {\n      cssLoaderPreamble = cssLoaderPreamble.replace('l.href', `l.media='only x';l.onload=function(){l.media=m};l.href`);\n    }\n\n    // the reduced critical CSS gets injected into a new <style> tag\n    const style = document.createElement('style');\n    style.appendChild(document.createTextNode(sheet));\n    link.parentNode.insertBefore(style, link);\n\n    if (this.options.inlineThreshold && sheet.length < this.options.inlineThreshold) {\n      style.$$reduce = false;\n      this.logger.info(`\\u001b[32mInlined all of ${href} (${sheet.length} was below the threshold of ${this.options.inlineThreshold})\\u001b[39m`);\n      if (asset) {\n        // delete compilation.assets[relativePath];\n      } else {\n        this.logger.warn(`  > ${href} was not found in assets. the resource may still be emitted but will be unreferenced.`);\n      }\n      link.parentNode.removeChild(link);\n      return;\n    }\n\n    // drop references to webpack asset locations onto the tag, used for later reporting and in-place asset updates\n    style.$$name = href;\n    style.$$asset = asset;\n    style.$$assetName = relativePath;\n    // style.$$assets = compilation.assets;\n    style.$$assets = false;\n    style.$$links = [link];\n\n    // Allow disabling any mutation of the stylesheet link:\n    if (preloadMode === false) return;\n\n    let noscriptFallback = false;\n\n    if (preloadMode === 'body') {\n      document.body.appendChild(link);\n    } else {\n      link.setAttribute('rel', 'preload');\n      link.setAttribute('as', 'style');\n      if (preloadMode === 'js' || preloadMode === 'js-lazy') {\n        const script = document.createElement('script');\n        const js = `${cssLoaderPreamble}$loadcss(${JSON.stringify(href)}${lazy ? (',' + JSON.stringify(media || 'all')) : ''})`;\n        script.appendChild(document.createTextNode(js));\n        link.parentNode.insertBefore(script, link.nextSibling);\n        style.$$links.push(script);\n        cssLoaderPreamble = '';\n        noscriptFallback = true;\n      } else if (preloadMode === 'media') {\n        // @see https://github.com/filamentgroup/loadCSS/blob/af1106cfe0bf70147e22185afa7ead96c01dec48/src/loadCSS.js#L26\n        link.setAttribute('rel', 'stylesheet');\n        link.removeAttribute('as');\n        link.setAttribute('media', 'only x');\n        link.setAttribute('onload', `this.media='${media || 'all'}'`);\n        noscriptFallback = true;\n      } else if (preloadMode === 'swap') {\n        link.setAttribute('onload', \"this.rel='stylesheet'\");\n        noscriptFallback = true;\n      } else {\n        const bodyLink = document.createElement('link');\n        bodyLink.setAttribute('rel', 'stylesheet');\n        if (media) bodyLink.setAttribute('media', media);\n        bodyLink.setAttribute('href', href);\n        document.body.appendChild(bodyLink);\n        style.$$links.push(bodyLink);\n      }\n    }\n\n    if (this.options.noscriptFallback !== false && noscriptFallback) {\n      const noscript = document.createElement('noscript');\n      const noscriptLink = document.createElement('link');\n      noscriptLink.setAttribute('rel', 'stylesheet');\n      noscriptLink.setAttribute('href', href);\n      if (media) noscriptLink.setAttribute('media', media);\n      noscript.appendChild(noscriptLink);\n      link.parentNode.insertBefore(noscript, link.nextSibling);\n      style.$$links.push(noscript);\n    }\n  }\n\n  /**\n   * Parse the stylesheet within a <style> element, then reduce it to contain only rules used by the document.\n   */\n  async processStyle (style) {\n    if (style.$$reduce === false) return;\n\n    const name = style.$$name ? style.$$name.replace(/^\\//, '') : 'inline CSS';\n    const options = this.options;\n    const document = style.ownerDocument;\n    const head = document.querySelector('head');\n    let keyframesMode = options.keyframes || 'critical';\n    // we also accept a boolean value for options.keyframes\n    if (keyframesMode === true) keyframesMode = 'all';\n    if (keyframesMode === false) keyframesMode = 'none';\n\n    // basically `.textContent`\n    let sheet = style.childNodes.length > 0 && [].map.call(style.childNodes, node => node.nodeValue).join('\\n');\n\n    // store a reference to the previous serialized stylesheet for reporting stats\n    const before = sheet;\n\n    // Skip empty stylesheets\n    if (!sheet) return;\n\n    const ast = parseStylesheet(sheet);\n    const astInverse = options.pruneSource ? parseStylesheet(sheet) : null;\n\n    // a string to search for font names (very loose)\n    let criticalFonts = '';\n\n    const failedSelectors = [];\n\n    const criticalKeyframeNames = [];\n\n    // Walk all CSS rules, marking unused rules with `.$$remove=true` for removal in the second pass.\n    // This first pass is also used to collect font and keyframe usage used in the second pass.\n    walkStyleRules(ast, markOnly(rule => {\n      if (rule.type === 'rule') {\n        // Filter the selector list down to only those match\n        rule.filterSelectors(sel => {\n          // Strip pseudo-elements and pseudo-classes, since we only care that their associated elements exist.\n          // This means any selector for a pseudo-element or having a pseudo-class will be inlined if the rest of the selector matches.\n          if (sel !== ':root') {\n            sel = sel.replace(/(?:>\\s*)?::?[a-z-]+\\s*(\\{|$)/gi, '$1').trim();\n          }\n          if (!sel) return false;\n\n          try {\n            return document.querySelector(sel) != null;\n          } catch (e) {\n            failedSelectors.push(sel + ' -> ' + e.message);\n            return false;\n          }\n        });\n        // If there are no matched selectors, remove the rule:\n        if (rule.selectors.length === 0) {\n          return false;\n        }\n\n        if (rule.declarations) {\n          for (let i = 0; i < rule.declarations.length; i++) {\n            const decl = rule.declarations[i];\n\n            // detect used fonts\n            if (decl.property && decl.property.match(/\\bfont(-family)?\\b/i)) {\n              criticalFonts += ' ' + decl.value;\n            }\n\n            // detect used keyframes\n            if (decl.property === 'animation' || decl.property === 'animation-name') {\n              // @todo: parse animation declarations and extract only the name. for now we'll do a lazy match.\n              const names = decl.value.split(/\\s+/);\n              for (let j = 0; j < names.length; j++) {\n                const name = names[j].trim();\n                if (name) criticalKeyframeNames.push(name);\n              }\n            }\n          }\n        }\n      }\n\n      // keep font rules, they're handled in the second pass:\n      if (rule.type === 'font-face') return;\n\n      // If there are no remaining rules, remove the whole rule:\n      const rules = rule.rules && rule.rules.filter(rule => !rule.$$remove);\n      return !rules || rules.length !== 0;\n    }));\n\n    if (failedSelectors.length !== 0) {\n      this.logger.warn(`${failedSelectors.length} rules skipped due to selector errors:\\n  ${failedSelectors.join('\\n  ')}`);\n    }\n\n    const shouldPreloadFonts = options.fonts === true || options.preloadFonts === true;\n    const shouldInlineFonts = options.fonts !== false && options.inlineFonts === true;\n\n    const preloadedFonts = [];\n    // Second pass, using data picked up from the first\n    walkStyleRulesWithReverseMirror(ast, astInverse, rule => {\n      // remove any rules marked in the first pass\n      if (rule.$$remove === true) return false;\n\n      applyMarkedSelectors(rule);\n\n      // prune @keyframes rules\n      if (rule.type === 'keyframes') {\n        if (keyframesMode === 'none') return false;\n        if (keyframesMode === 'all') return true;\n        return criticalKeyframeNames.indexOf(rule.name) !== -1;\n      }\n\n      // prune @font-face rules\n      if (rule.type === 'font-face') {\n        let family, src;\n        for (let i = 0; i < rule.declarations.length; i++) {\n          const decl = rule.declarations[i];\n          if (decl.property === 'src') {\n            // @todo parse this properly and generate multiple preloads with type=\"font/woff2\" etc\n            src = (decl.value.match(/url\\s*\\(\\s*(['\"]?)(.+?)\\1\\s*\\)/) || [])[2];\n          } else if (decl.property === 'font-family') {\n            family = decl.value;\n          }\n        }\n\n        if (src && shouldPreloadFonts && preloadedFonts.indexOf(src) === -1) {\n          preloadedFonts.push(src);\n          const preload = document.createElement('link');\n          preload.setAttribute('rel', 'preload');\n          preload.setAttribute('as', 'font');\n          preload.setAttribute('crossorigin', 'anonymous');\n          preload.setAttribute('href', src.trim());\n          head.appendChild(preload);\n        }\n\n        // if we're missing info, if the font is unused, or if critical font inlining is disabled, remove the rule:\n        if (!family || !src || criticalFonts.indexOf(family) === -1 || !shouldInlineFonts) return false;\n      }\n    });\n\n    sheet = serializeStylesheet(ast, { compress: this.options.compress !== false }).trim();\n\n    // If all rules were removed, get rid of the style element entirely\n    if (sheet.trim().length === 0) {\n      if (style.parentNode) {\n        style.parentNode.removeChild(style);\n      }\n      return;\n    }\n\n    let afterText = '';\n    if (options.pruneSource) {\n      const sheetInverse = serializeStylesheet(astInverse, { compress: this.options.compress !== false });\n      const asset = style.$$asset;\n      if (asset) {\n        // if external stylesheet would be below minimum size, just inline everything\n        const minSize = this.options.minimumExternalSize;\n        if (minSize && sheetInverse.length < minSize) {\n          this.logger.info(`\\u001b[32mInlined all of ${name} (non-critical external stylesheet would have been ${sheetInverse.length}b, which was below the threshold of ${minSize})\\u001b[39m`);\n          setNodeText(style, before);\n          // remove any associated external resources/loaders:\n          if (style.$$links) {\n            for (const link of style.$$links) {\n              const parent = link.parentNode;\n              if (parent) parent.removeChild(link);\n            }\n          }\n          // delete the webpack asset:\n          // delete style.$$assets[style.$$assetName];\n          return;\n        }\n\n        const percent = sheetInverse.length / before.length * 100;\n        afterText = `, reducing non-inlined size ${percent | 0}% to ${prettyBytes(sheetInverse.length)}`;\n        // style.$$assets[style.$$assetName] = new sources.LineToLineMappedSource(sheetInverse, style.$$assetName, before);\n      } else {\n        this.logger.warn('pruneSource is enabled, but a style (' + name + ') has no corresponding Webpack asset.');\n      }\n    }\n\n    // replace the inline stylesheet with its critical'd counterpart\n    setNodeText(style, sheet);\n\n    // output stats\n    const percent = sheet.length / before.length * 100 | 0;\n    this.logger.info('\\u001b[32mInlined ' + prettyBytes(sheet.length) + ' (' + percent + '% of original ' + prettyBytes(before.length) + ') of ' + name + afterText + '.\\u001b[39m');\n  }\n}\n"],"names":["createDocument","html","jsdom","JSDOM","contentType","window","document","$jsdom","serializeDocument","serialize","setNodeText","node","text","lastChild","removeChild","appendChild","ownerDocument","createTextNode","const","css","require","parseStylesheet","stylesheet","parse","serializeStylesheet","ast","options","stringify","markOnly","predicate","rule","sel","selectors","$$remove","$$markedSelectors","_other","applyMarkedSelectors","walkStyleRules","iterator","rules","filter","undefined","filterSelectors","walkStyleRulesWithReverseMirror","node2","splitFilter","index","rules2","rule2","a","b","aOut","bOut","let","length","push","module","exports","Critters","constructor","Object","assign","pruneSource","urlFilter","RegExp","test","bind","logger","outputPath","publicPath","readFile","filename","fs","Promise","resolve","reject","callback","err","data","process","styles","slice","call","querySelectorAll","all","map","style","processStyle","mergeStylesheets","body","className","bodyClasses","external","externalSheets","link","embedLinkedStylesheet","first","sheet","warn","textContent","i","remove","compress","before","processor","postcss","cssnano","result","cssLoaderPreamble","lazy","preloadMode","replace","createElement","parentNode","insertBefore","inlineThreshold","$$reduce","info","href","$$name","$$asset","asset","$$assetName","relativePath","$$assets","$$links","noscriptFallback","setAttribute","script","js","JSON","media","nextSibling","removeAttribute","bodyLink","noscript","noscriptLink","getAttribute","preload","match","normalizedPath","pathPrefix","indexOf","substring","path","relative","name","head","querySelector","keyframesMode","keyframes","childNodes","nodeValue","join","astInverse","criticalFonts","failedSelectors","criticalKeyframeNames","type","trim","e","message","declarations","decl","property","value","names","split","j","shouldPreloadFonts","fonts","preloadFonts","shouldInlineFonts","inlineFonts","preloadedFonts","family","src","afterText","sheetInverse","minSize","minimumExternalSize","parent","percent","prettyBytes"],"mappings":"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"}